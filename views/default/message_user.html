{{extend 'layout.html'}}
<head xmlns="http://www.w3.org/1999/html">
    <script type="text/javascript" src="http://www.parsecdn.com/js/parse-latest.js"></script>
</head>

<html>
    <body>
        <script src="{{=URL('static', 'js/pubnub-3.7.18.min.js')}}"></script>
    </body>
    <div id="container">
        <div id="header">{{=tutor_name}}</div>
        <div id="messages" class="scrollable-messages">
        {{for i in range(len(messages.get("results"))):}}
            <div id="tutorName">{{=messages.get("results")[i].get("senderId")}}</div>
            <div id="message">{{=messages.get("results")[i].get("messageText")}}</div>
        {{pass}}
        </div>
    </div>

    <div id="input-area">
        <textarea id="message-input" class="no-menu" maxlength="" aria-label="Message input"  spellcheck="true"></textarea>
        <div id="send-message">
            <a id="send-message-btn" class="btn btn-primary">Send</a>
        </div>
    </div>
</html>

<script>
    $("#send-message").click(function(e){
        publish();
    });

    $('#messages').scrollTop($('#messages')[0].scrollHeight - $('#messages')[0].clientHeight);

    function publish(){
        pubnub = PUBNUB({
            publish_key   : 'demo',
            subscribe_key : 'demo'
        });

        pubnub.publish({
            channel : "hello_world",
            message : "Hello from PubNub Docs!",
            callback: function(m){ console.log(m) }
        })
    }
</script>